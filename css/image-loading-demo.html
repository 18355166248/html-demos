<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›¾ç‰‡åŠ è½½ä¸å½±å“DOMContentLoadedæ¼”ç¤º</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }

    .demo-section {
      border: 2px solid #007bff;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      background: #f8f9fa;
    }

    .event-log {
      background: #000;
      color: #00ff00;
      padding: 15px;
      border-radius: 5px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      max-height: 400px;
      overflow-y: auto;
      margin: 15px 0;
    }

    .image-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .image-card {
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 5px;
      text-align: center;
      background: white;
    }

    .image-card img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 5px;
    }

    .status {
      margin-top: 10px;
      padding: 5px;
      border-radius: 3px;
      font-size: 12px;
    }

    .status.loading {
      background: #fff3cd;
      color: #856404;
    }

    .status.loaded {
      background: #d4edda;
      color: #155724;
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
    }

    .highlight-box {
      background: #e7f3ff;
      border-left: 4px solid #007bff;
      padding: 15px;
      margin: 20px 0;
    }

    .button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }

    .button:hover {
      background: #0056b3;
    }

    .progress-bar {
      width: 100%;
      height: 20px;
      background: #e9ecef;
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress-fill {
      height: 100%;
      background: #28a745;
      width: 0%;
      transition: width 0.3s ease;
    }
  </style>
</head>

<body>
  <h1>ğŸ¯ å›¾ç‰‡åŠ è½½ä¸å½±å“DOMContentLoadedæ¼”ç¤º</h1>

  <div class="highlight-box">
    <h3>ğŸ“š æ ¸å¿ƒæ¦‚å¿µ</h3>
    <p><strong>DOMContentLoaded</strong> äº‹ä»¶åœ¨HTMLæ–‡æ¡£è¢«å®Œå…¨åŠ è½½å’Œè§£ææ—¶è§¦å‘ï¼Œ<strong>ä¸ç­‰å¾…å›¾ç‰‡ã€æ ·å¼è¡¨ç­‰å¤–éƒ¨èµ„æº</strong>ã€‚</p>
    <p><strong>window.onload</strong> äº‹ä»¶åœ¨æ‰€æœ‰èµ„æºï¼ˆåŒ…æ‹¬å›¾ç‰‡ï¼‰éƒ½åŠ è½½å®Œæˆåæ‰è§¦å‘ã€‚</p>
  </div>

  <div class="demo-section">
    <h2>ğŸ–¼ï¸ å›¾ç‰‡åŠ è½½æµ‹è¯•</h2>
    <p>ç‚¹å‡»æŒ‰é’®å¼€å§‹åŠ è½½å›¾ç‰‡ï¼Œè§‚å¯Ÿäº‹ä»¶è§¦å‘é¡ºåºï¼š</p>

    <button class="button" onclick="startImageLoading()">å¼€å§‹åŠ è½½å›¾ç‰‡</button>
    <button class="button" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>

    <div class="progress-bar">
      <div class="progress-fill" id="progressBar"></div>
    </div>

    <div class="image-grid" id="imageGrid">
      <!-- å›¾ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
    </div>
  </div>

  <div class="demo-section">
    <h2>ğŸ“Š äº‹ä»¶æ—¥å¿—</h2>
    <div class="event-log" id="eventLog">
      <div>ç­‰å¾…å¼€å§‹...</div>
    </div>
  </div>

  <script>
    let startTime;
    let loadedImages = 0;
    const totalImages = 8;

    // æ—¥å¿—å‡½æ•°
    function logEvent (message, type = 'info') {
      const timestamp = Date.now();
      const elapsed = startTime ? timestamp - startTime : 0;
      const logDiv = document.getElementById('eventLog');
      const logEntry = document.createElement('div');

      const timeStr = `[${elapsed}ms]`;
      const icon = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';

      logEntry.innerHTML = `<span style="color: #00ff00;">${timeStr}</span> ${icon} ${message}`;
      logDiv.appendChild(logEntry);
      logDiv.scrollTop = logDiv.scrollHeight;

      console.log(`${timeStr} ${message}`);
    }

    // DOMContentLoaded äº‹ä»¶ç›‘å¬
    document.addEventListener("DOMContentLoaded", function () {
      logEvent("ğŸ‰ DOMContentLoaded è§¦å‘ - HTMLæ–‡æ¡£è§£æå®Œæˆ", 'success');
    });

    // window.onload äº‹ä»¶ç›‘å¬
    window.addEventListener("load", function () {
      logEvent("ğŸ window.onload è§¦å‘ - æ‰€æœ‰èµ„æºåŠ è½½å®Œæˆ", 'success');
    });

    // å¼€å§‹å›¾ç‰‡åŠ è½½
    function startImageLoading () {
      startTime = Date.now();
      loadedImages = 0;

      logEvent("ğŸš€ å¼€å§‹åŠ è½½å›¾ç‰‡");

      const imageGrid = document.getElementById('imageGrid');
      imageGrid.innerHTML = '';

      // åˆ›å»º8å¼ å›¾ç‰‡ï¼Œæ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
      for (let i = 1; i <= totalImages; i++) {
        const imageCard = document.createElement('div');
        imageCard.className = 'image-card';
        imageCard.innerHTML = `
          <img src="https://picsum.photos/300/200?random=${i}&delay=${Math.random() * 3000}"
               alt="å›¾ç‰‡${i}"
               onload="onImageLoad(${i})"
               onerror="onImageError(${i})">
          <div class="status loading" id="status${i}">åŠ è½½ä¸­...</div>
        `;
        imageGrid.appendChild(imageCard);
      }

      logEvent("ğŸ“ å›¾ç‰‡å…ƒç´ å·²æ·»åŠ åˆ°DOM");
    }

    // å›¾ç‰‡åŠ è½½æˆåŠŸ
    function onImageLoad (imageIndex) {
      loadedImages++;
      const statusEl = document.getElementById(`status${imageIndex}`);
      statusEl.className = 'status loaded';
      statusEl.textContent = 'åŠ è½½å®Œæˆ';

      logEvent(`ğŸ–¼ï¸ å›¾ç‰‡${imageIndex} åŠ è½½å®Œæˆ (${loadedImages}/${totalImages})`);

      // æ›´æ–°è¿›åº¦æ¡
      const progress = (loadedImages / totalImages) * 100;
      document.getElementById('progressBar').style.width = progress + '%';

      if (loadedImages === totalImages) {
        logEvent("ğŸŠ æ‰€æœ‰å›¾ç‰‡åŠ è½½å®Œæˆï¼", 'success');
      }
    }

    // å›¾ç‰‡åŠ è½½å¤±è´¥
    function onImageError (imageIndex) {
      const statusEl = document.getElementById(`status${imageIndex}`);
      statusEl.className = 'status error';
      statusEl.textContent = 'åŠ è½½å¤±è´¥';

      logEvent(`âŒ å›¾ç‰‡${imageIndex} åŠ è½½å¤±è´¥`, 'error');
    }

    // æ¸…ç©ºæ—¥å¿—
    function clearLog () {
      document.getElementById('eventLog').innerHTML = '<div>æ—¥å¿—å·²æ¸…ç©º...</div>';
    }

    // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹æ—¥å¿—
    logEvent("ğŸ“„ é¡µé¢å¼€å§‹åŠ è½½");
  </script>

</body>

</html>
